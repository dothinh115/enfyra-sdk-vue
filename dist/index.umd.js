(function(f,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],i):(f=typeof globalThis<"u"?globalThis:f||self,i(f.EnfyraVueSDK={},f.Vue))})(this,function(f,i){"use strict";const m=i.ref({apiUrl:"",apiPrefix:"/api",defaultHeaders:{}});function v(){return{setConfig:n=>{m.value={...m.value,...n}},getConfig:()=>m.value}}async function w(e,t={}){const{method:n="GET",body:l,headers:d={},query:y={},baseURL:o}=t,{apiUrl:C,defaultHeaders:h={}}=m.value,c=o||C,g=new URL(e.startsWith("/")?e.slice(1):e,c.endsWith("/")?c:`${c}/`);Object.entries(y).forEach(([s,r])=>{r!=null&&g.searchParams.append(s,String(r))});const p={"Content-Type":"application/json",...h,...d},a={method:n.toUpperCase(),headers:p};l&&n.toUpperCase()!=="GET"&&(l instanceof FormData?(delete p["Content-Type"],a.body=l):a.body=JSON.stringify(l));try{const s=await fetch(g.toString(),a);if(!s.ok){let u;try{u=await s.json()}catch{u={message:s.statusText}}throw{response:{data:u}}}const r=s.headers.get("content-type");return r!=null&&r.includes("application/json")?await s.json():await s.text()}catch(s){throw s}}function L(e,t){var y;let n="Request failed",l="UNKNOWN_ERROR",d;if((y=e==null?void 0:e.response)!=null&&y.data){const o=e.response.data;o.error?(n=o.error.message||o.message||"Request failed",l=o.error.code,d=o.error.correlationId):n=o.message||"Request failed"}else if(e!=null&&e.data){const o=e.data;o.error?(n=o.error.message||o.message||"Request failed",l=o.error.code,d=o.error.correlationId):n=o.message||"Request failed"}else e!=null&&e.message&&(n=e.message);console.error(`[Enfyra API Error] ${l}: ${n}`,{context:t,correlationId:d,error:e})}function j(e,t={}){const{method:n="get",body:l,query:d,errorContext:y}=t,{apiUrl:o,apiPrefix:C}=m.value,h=i.ref(null),c=i.ref(null),g=i.ref(!1);return{data:h,error:c,pending:g,execute:async a=>{g.value=!0,c.value=null;try{const s=(typeof e=="function"?e():e).replace(/^\/?api\/?/,"").replace(/^\/+/,""),r=(a==null?void 0:a.body)||i.unref(l),u=i.unref(d),q=(...b)=>b.filter(Boolean).join("/"),U=o+(C||"");if(!t.disableBatch&&(a!=null&&a.ids)&&a.ids.length>0&&(n.toLowerCase()==="patch"||n.toLowerCase()==="delete")){const b=a.ids.map(async E=>{const A=q(s,E);return w(A,{baseURL:U,method:n,body:r?i.toRaw(r):void 0,headers:t.headers,query:u})}),R=await Promise.all(b);return h.value=R,R}if(!t.disableBatch&&n.toLowerCase()==="post"&&(a!=null&&a.files)&&Array.isArray(a.files)&&a.files.length>0){const b=a.files.map(async E=>w(s,{baseURL:U,method:n,body:E,headers:t.headers,query:u})),R=await Promise.all(b);return h.value=R,R}const T=a!=null&&a.id?q(s,a.id):s,P=await w(T,{baseURL:U,method:n,body:r?i.toRaw(r):void 0,headers:t.headers,query:u});return h.value=P,P}catch(s){return c.value=s,L(s,y),null}finally{g.value=!1}}}}f.$fetch=w,f.useEnfyraApi=j,f.useEnfyraConfig=v,Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});
